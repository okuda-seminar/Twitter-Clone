# How to set up a new service
## Establish environment
For each service, there should be files for both the application server and the database. Therefore, you will need the following files:
* `Dockerfile`: Contains instructions for building the application server and the database. Currently, we are using PostgreSQL.
* `docker-compose.yml`: Defines the configuration to run multiple containers.
* `.env`: Contains configurations.


You can find the actual contents in the commit [[go/tweets] Establish environment for tweets service.](https://github.com/okuda-seminar/Twitter-Clone/commit/e571f6cc67ca6190efd64750a8c9a5df45956ed2)

Please note:

`.env` is ignored by Git. Therefore, you need to create an example configuration in `.env.sample`, copy it to `.env`, and edit it if necessary.

## Introduce Goa
We utilize Goa to streamline the development of microservices. Goa automates the generation of boilerplate code for handling HTTP requests and responses based on the API definition.
This significantly reduces manual coding efforts, saving time and reducing potential errors.

To get started, follow these steps after entering the application container:

1. Initialize Go modules with `go mod init ${your service name}.`
2. Install Goa using `go install goa.design/goa/v3/cmd/goa@v3`.

For more detailed information, refer to [the official site](https://goa.design/).

## Design your service API
Design your service API in `design/design.go` to enable Goa to generate boilerplate code.
You can refer to [the example design](https://github.com/okuda-seminar/Twitter-Clone/blob/3d62634778e12692d9d888ed65102d413809041f/go/tweets/design/design.go).
However, it's highly recommended to go through the official tutorial.

After designing your API, run `goa gen ${your service name}/design` to generate the code.

Next, execute the `goa example` command to generate a basic implementation of the service.
This will create server files that initialize an HTTP server and client files capable of making requests to the server.

`goa example ${your service name}/design`

However, note that the code generated by `goa example` does not handle database connections.
You'll need to add code to handle this, as demonstrated in [this commit](https://github.com/okuda-seminar/Twitter-Clone/commit/3d62634778e12692d9d888ed65102d413809041f).

## Implement your API
With the server generated and the API skeleton in place, you can proceed to implement your API.
Refer to [this commit](https://github.com/okuda-seminar/Twitter-Clone/commit/513b140188b95c130953ca82d5cf505fcd615751) for an implementation example.
